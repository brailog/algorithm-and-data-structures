arrStock = new Array(1 ); for (i = 0; i < arrStock.length; ++i) { arrStock [i] = new Array(31); } //******************************************************************************* //This string is a list of all the stock options //******************************************************************************* arrStock [0] [0] = "5985"; arrStock [0] [1] = "919"; arrStock [0] [2] = "2"; arrStock [0] [3] = "4"; arrStock [0] [4] = "None"; arrStock [0] [5] = "55"; arrStock [0] [6] = "None"; arrStock [0] [7] = "0"; arrStock [0] [8] = ""; arrStock [0] [9] = "0"; arrStock [0] [10] = ""; arrStock [0] [11] = "0"; arrStock [0] [12] = ""; arrStock [0] [13] = "0"; arrStock [0] [14] = ""; arrStock [0] [15] = "0"; arrStock [0] [16] = ""; arrStock [0] [17] = "0"; arrStock [0] [18] = ""; arrStock [0] [19] = "0"; arrStock [0] [20] = ""; arrStock [0] [21] = "206"; arrStock [0] [22] = "None"; arrStock [0] [23] = "70"; arrStock [0] [24] = "None"; arrStock [0] [25] = "0"; arrStock [0] [26] = ""; arrStock [0] [27] = "ACJS017"; arrStock [0] [28] = ""; arrStock [0] [29] = ""; arrStock [0] [30] = ""; arrStock [0] [31] = ""; arrStock [0] [32] = ""; arrStock [0] [33] = ""; arrStock [0] [34] = ""; arrStock [0] [35] = ""; //******************************************************************************* //Store product Type //******************************************************************************* var ProductTypeID = 15; //******************************************************************************* // Store No Of Dropdowns //******************************************************************************* var NoOfDropDowns = 0; switch(ProductTypeID) { case 7:case 10:case 12:case 14: NoOfDropDowns = 2; break; case 5: NoOfDropDowns = 5; break; case 6:case 11: NoOfDropDowns = 3; break; case 9: NoOfDropDowns = 1; break; case 13: NoOfDropDowns = 0; break; case 15: NoOfDropDowns = 0; break; case 16: NoOfDropDowns = 2; break; case 17: NoOfDropDowns = 3; break; default: NoOfDropDowns = 4; } //alert(ProductTypeID); //********************************************************************** //*********************************************************************** // The NEW WAY STARTS //*********************************************************************** //*********************************************************************** //*********************************************************************** var Drop1Value = 0; var Drop2Value = 0; var Drop3Value = 0; var Drop4Value = 0; var Drop5Value = 0; var Drop1Position = 0; var Drop2Position = 0; var Drop3Position = 0; var Drop4Position = 0; var Drop5Position = 0; function BuildFirstDropDown() { var iDropDownNo = 0; var iArrayIDPos = 0; var iNextDropDownNo = 0; switch(ProductTypeID) { case 1:case 6: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 5; iNextDropDownNo = 2; break; case 2:case 3:case 4:case 5: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 13; iNextDropDownNo = 2; break; case 7: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 17; iNextDropDownNo = 2; break; case 8: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 19; iNextDropDownNo = 2; break; case 9: iDropDownNo = 1; iArrayIDPos = 21; iNextDropDownNo = 1; break; case 10: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 21; iNextDropDownNo = 2; break; case 11: iDropDownNo = 1; iArrayIDPos = 23; iNextArrayIDPos = 21; iNextDropDownNo = 2; break; case 14: iDropDownNo = 1; iArrayIDPos = 23; iNextArrayIDPos = 21; iNextDropDownNo = 2; break; case 12: iDropDownNo = 1; iArrayIDPos = 3; iNextArrayIDPos = 23; iNextDropDownNo = 2; break; case 15: iDropDownNo = 1; iArrayIDPos = 0; iNextArrayIDPos = 0; iNextDropDownNo = 0; break; case 16: iDropDownNo = 1; iArrayIDPos = 28; iNextArrayIDPos = 30; iNextDropDownNo = 2; break; case 17: iDropDownNo = 1; iArrayIDPos = 32; iNextArrayIDPos = 34; iNextDropDownNo = 2; break; default: //Do Nothing } var iOption = 1; var objDropDown = eval("document.forms['product_infoForm'].option" + iDropDownNo); eval("Drop" + iDropDownNo + "Position= " + iArrayIDPos); eval("Drop" + iDropDownNo + "Value= objDropDown.value"); if (arrStock.length > 0) { //Build DropDown eval("objDropDown.options[0] = new Option('please select','')"); var sTempText; for (var i = 0; i < 1; ++i) { //Ignore any single quotes sTempText = arrStock [i][iArrayIDPos + 1].replace(/\'/g,"\\\'"); if (AddOption(iDropDownNo, arrStock [i][iArrayIDPos]) == true) { eval("objDropDown.options[" + iOption + "] = new Option('" + sTempText + "','" + arrStock [i][iArrayIDPos] + "')"); iOption = iOption + 1; } } //End For Loop } //End IF //If just one item (and the please select) then make that one selected if (objDropDown.length == 2) { //Now we need to automatically get the next dropdown objDropDown.selectedIndex = 1; objDropDown.style.display = "none"; //There are single quotes in the dropdown values. //Need to tidy them up sTempText = objDropDown.options[objDropDown.selectedIndex].text; sTempText = sTempText.replace(/\'/g,"\\\'") ; eval("document.getElementById('spanOption1').innerHTML= '" + sTempText + "'"); eval("document.getElementById('spanOption1').style.display = 'inline'"); try{ objDropDown.onchange(); }catch(e) {} } if (iNextDropDownNo <= NoOfDropDowns) { CheckIfItsInStock(iNextDropDownNo); } } function toggle(){ var style2 = document.getElementById("goh").style; alert(style2) style2.display = "block"; } function BuildDropDown(iDropDownNo, iArrayIDPos, iNextArrayIDPos) { try{ var iOption = 1; var objDropDown = eval("document.forms['product_infoForm'].option" + iDropDownNo); // alert(objDropDown.value) if (objDropDown.value != ""){ var iNextDropDownNo = iDropDownNo + 1 var objNextDropDown = eval("document.forms['product_infoForm'].option" + iNextDropDownNo); switch(iDropDownNo) { case 1: ClearDropDown(2); ClearDropDown(3); ClearDropDown(4); ClearDropDown(5); case 2: ClearDropDown(3); ClearDropDown(4); ClearDropDown(5); case 3: ClearDropDown(4); ClearDropDown(5); case 4: ClearDropDown(5); break; default: //Do Nothing } eval("Drop" + iDropDownNo + "Position= " + iArrayIDPos); eval("Drop" + iDropDownNo + "Value= objDropDown.value"); //alert(Drop1Value + "-" + Drop1Position + "\n" + Drop2Value + "-" + Drop2Position + "\n" + Drop3Value + "-" + Drop3Position + "\n" + Drop4Value + "-" + Drop4Position + "\n" + Drop5Value + "-" + Drop5Position + "\n" ); if (arrStock.length > 0) { objNextDropDown.options[0] = new Option('please select',''); //var style2 = document.getElementById("spanOption" + iNextDropDownNo).style; //alert("span" + iNextDropDownNo) //style2.display = "block"; //Build DropDown eval("objNextDropDown.options[0] = new Option('please select','')"); var sTempText; for (var i = 0; i < 1; ++i) { //Ignore any single quotes sTempText = arrStock [i][iNextArrayIDPos + 1].replace(/\'/g,"\\\'"); if (AddOption(iDropDownNo +1, arrStock [i][iNextArrayIDPos], iNextArrayIDPos) == true) { eval("objNextDropDown.options[" + iOption + "] = new Option('" + sTempText + "','" + arrStock [i][iNextArrayIDPos] + "')"); iOption = iOption + 1; //alert(iNextArrayIDPos) } } //End For Loop } //End IF CheckIfItsInStock(iNextDropDownNo); }else{ //alert("HERE") //BuildFirstDropDown() } }catch(e) {} } function CheckIfItsInStock(iNextDropDownNo) { var objDropDown = eval("document.forms['product_infoForm'].option" + iNextDropDownNo); var dropItems = objDropDown.length; //var iPrevDropDownNo = iNextDropDownNo - 1; //alert(dropItems) //If just one item remove other drop downs if (dropItems == 1) { //Now recursivly hide all drop downs because no items in dropdowns //And display no optons available text for (i=iNextDropDownNo; i < 5; i++) { if (eval("document.getElementById('spanOption" + i + "')") != null) { eval("document.getElementById('option" + i + "').style.display = 'none'"); eval("document.getElementById('spanOption" + i + "').innerHTML= 'No Options available'"); eval("document.getElementById('spanOption" + i + "').style.display = 'inline'"); } } //Not in stock therefore; //1) Change In Stock text //2) Disabled Quantity button document.getElementById("stock_level").innerHTML= "OUT OF STOCK"; document.getElementById("spanOutOfStockImage").style.display = "inline"; document.getElementById("spanAddToBasket").style.display = "none"; document.getElementById("spanQuantity").style.display = "none"; // document.getElementById("spanAvailability").style.display = "none"; //document.getElementById("spanNoAvailability").style.display = "inline"; document.getElementById("prod_quantity").disabled = true; } else { document.getElementById("stock_level").innerHTML= ""; document.getElementById("spanOutOfStockImage").style.display = "none"; document.getElementById("spanAddToBasket").style.display = "inline"; document.getElementById("spanQuantity").style.display = "inline"; //document.getElementById("spanAvailability").style.display = "inline"; //document.getElementById("spanNoAvailability").style.display = "none"; document.getElementById("prod_quantity").disabled = false; } //If just one item (the "please select") then make that one selected if (dropItems == 2) { //Now we need to automatically get the next dropdown objDropDown.selectedIndex = 1; objDropDown.style.display = "none"; eval("document.getElementById('spanOption" + iNextDropDownNo + "').innerHTML= '" + objDropDown.options[objDropDown.selectedIndex].text + "'"); eval("document.getElementById('spanOption" + iNextDropDownNo + "').style.display = 'inline'"); try{ objDropDown.onchange(); }catch(e) {} } if (dropItems > 2) { objDropDown.style.display = "inline"; eval("document.getElementById('spanOption" + iNextDropDownNo + "').style.display = 'none'"); } } var stock_level function GetStockID(iDropDownNo, iArrayIDPos) { var blnMatch = false; //If -1 is passed that is to indicate that there are NO options for this product. //All Options have been set to "none" //But there will be one Stock line with Stock sku and stock level. //We still need to check this for stock level if (iDropDownNo == -1) { for (var i = 0; i < 1; ++i) { if (parseFloat(arrStock [i][2]) > parseFloat(0)) { document.forms['product_infoForm'].stock_id.value = arrStock [i][0] blnMatch = true; stock_level=arrStock [i][2] } } } else { var objDropDown = eval("document.forms['product_infoForm'].option" + iDropDownNo); eval("Drop" + iDropDownNo + "Value = objDropDown.options[objDropDown.selectedIndex].value"); eval("Drop" + iDropDownNo + "Position = iArrayIDPos "); // if (objDropDown.value != ""){ for (var i = 0; i < 1; ++i) { switch(NoOfDropDowns) { case 1: if ( (parseFloat(arrStock [i][2]) > parseFloat(0)) && (arrStock [i][Drop1Position] == Drop1Value) ) { document.forms['product_infoForm'].stock_id.value = arrStock [i][0] //document.getElementById("strCheckStock").innerHTML= "In Stock"; //document.getElementById("prod_quantity").disabled = false; blnMatch = true; stock_level=arrStock [i][2] } break; case 2: if ( (parseFloat(arrStock [i][2]) > parseFloat(0)) && (arrStock [i][Drop1Position] == Drop1Value) && (arrStock [i][Drop2Position] == Drop2Value) ) { document.forms['product_infoForm'].stock_id.value = arrStock [i][0] //document.getElementById("strCheckStock").innerHTML= "In Stock"; //document.getElementById("prod_quantity").disabled = false; blnMatch = true; stock_level=arrStock [i][2] } break; case 3: if ( (parseFloat(arrStock [i][2]) > parseFloat(0)) && (arrStock [i][Drop1Position] == Drop1Value) && (arrStock [i][Drop2Position] == Drop2Value) && (arrStock [i][Drop3Position] == Drop3Value) ) { document.forms['product_infoForm'].stock_id.value = arrStock [i][0] //document.getElementById("strCheckStock").innerHTML= "In Stock"; //document.getElementById("prod_quantity").disabled = false; blnMatch = true; stock_level=arrStock [i][2] } break; case 4: if ( (parseFloat(arrStock [i][2]) > parseFloat(0) ) && (arrStock [i][Drop1Position] == Drop1Value) && (arrStock [i][Drop2Position] == Drop2Value) && (arrStock [i][Drop3Position] == Drop3Value) && (arrStock [i][Drop4Position] == Drop4Value) ) { document.forms['product_infoForm'].stock_id.value = arrStock [i][0] //document.getElementById("strCheckStock").innerHTML= "In Stock"; //document.getElementById("prod_quantity").disabled = false; blnMatch = true; stock_level=arrStock [i][2] } break; case 5: if ( (parseFloat(arrStock [i][2]) > parseFloat(0)) && (arrStock [i][Drop1Position] == Drop1Value) && (arrStock [i][Drop2Position] == Drop2Value) && (arrStock [i][Drop3Position] == Drop3Value) && (arrStock [i][Drop4Position] == Drop4Value) && (arrStock [i][Drop5Position] == Drop5Value) ) { document.forms['product_infoForm'].stock_id.value = arrSto
Loyalty Scheme